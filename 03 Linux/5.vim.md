# 01 What is vim

`vim` 是一款命令行式文件编辑器，由于其具有的 **速度快** ， **适用范围广** ， **操作模式舒适** ， **快捷键及功能多** 等特点而深受喜爱。

* 几乎所有linux都会内置vim
* 是所有Unix及Linux系统下标准的编辑器
* vim具有**程序开发能力**，也可以用来对文件进行简单的编辑
* vim最大的特点是可以在**终端中使用**

# 02 vim的基本使用

* vim分为三种模式
	* 命令模式
	* 输入模式
	* 底线命令模式
	*具体模式转换可以参考下图

![](imgs/vim工作模式转化图.png)

[如何使用vim](https://zhuanlan.zhihu.com/p/120985792)

```
vim [文件]
# 打开文件或创建文件
```

- **_normal_ 模式 --> _insert_ 模式**：

	`i` (insert) ： 在当前光标所在字符的**前面**，转为输入模式；
	
	`I` ：在当前光标所在**行的行首**，转换为输入模式
	
	`a` (append) ：在当前光标所在字符的**后面**，转为输入模式；
	
	`A` ：在当前光标所在**行的行尾**，转换为输入模式
	
	`o` ：在当前光标所在**行的下方**，**新建一行**，并转为输入模式；
	
	`O` ：在当前光标所在**行的上方**，**新建一行**，并转为输入模式；

- **_insert_ 模式 --> _normal_ 模式：**

	键入“ _**Esc**键_ ”

* _**normal**_ 模式下关闭文件

	- _**:q**_  退出 _**（quit）**_
	
	- _**:wq**_ 保存并退出 _**（write quit）**_
	
	- _**:q!**_ 不保存并退出
	
	- _**:w**_ 保存 _**（write） :w + 文件名**_ 写入某个文件中
	
	- _**:w!**_ 强行保存
	
	- _**:wq**_ 或 _**:x**_ 保持并退出
	
	- _**ZZ**_ 保存并退出（_**按住Shift+z+z**_）
	
	- **_:saveas <path/to/file>_** 另存为 _**<path/to/file>**_ 

# 03 Vim的进阶使用

## 3.1 移动

在 `vim` 中，让光标移动是一件及其简单，优雅，快速的事情，可以进行移动的方式多种多样。

### 3.1.1 基本移动

```
    k
h       l
    j

Move around:  Use the cursor keys, or "h" to go left, "j" to go down, "k" to go up, "l" to go right。
```

如上面 `h` , `j` , `k` , `l` 所示的方位，分别的对应键盘的 左下上右。

### 3.1.2 屏幕滚动

- `<Ctrl-D>` - 向下滚动半屏
- `<Ctrl-U>` - 向上滚动半屏
- `<Ctrl-E>` - 向下滚动一行
- `<Ctrl-Y>` - 向上滚动一行
- `<Ctrl-F> / <Shift-Up>` - 向下滚动一屏
- `<Ctrl-B / <Shift-Down>` - 向上滚动一屏

### 3.1.3 特殊移动

#### 单词

- `w / <Shift-Right>` - 下一个单词的第一个字符，以 `()` , ` ` , `{}` , `;` 等符号隔开为一个单词
- `e` - 下一个单词的最后一个字符
- `W` - 下一个 **长单词** 的第一个字符，长单词的分割方法只以 ` ` 或 `<CR>` 为标志
- `E` - 下一个长单词的最后一个字符
- `b / <Shift-Left>` - 上一个单词的第一个字符
- `ge` - 上一个单词的最后一个字符
- `B` - 上一个长单词的第一个字符

> 以上的所有操作都可以在操作前按下数字 `n` 来重复执行。
> 即 `2w` 相当于按下2次 `w` 往后走2个单词

#### 行段

- `$` - 行末最后一个字符
- `0` - 行首第一个字符
- `^` - 行首第一个字符，忽略空格
- `gg / [[` - 文档首行
- `G / ]]` - 文档末行
- `:<n> / <n>G` - 移动到第n行
- `}` - 下一个段落，以空行为标志
- `{` - 上一个段落

#### 跳转

- `/<target>` - 跳转到 `target` 处， `n` 跳转到下一处， `N` 跳转到上一处
- `f<char>` - 跳转到当前行的下一个 `<char>` 处，`;` 前往下一处， `,` 前往上一处
- `F<char>` - 跳转到当前行的前一个 `<char>` 处
- `t<char>` - 跳转到当前行的下一个 `<char>` 的前一个字符处
- `T<char>` - 跳转到当前行的前一个 `<char>` 的前一个字符处
- `%` - 跳转到匹配的括号处
- `#` - 跳转到下一个相同的单词
- `*` - 跳转到前一个相同的单词
- `<Ctrl-O>` - 跳转到上一次光标停留的位置， `O` 代表 old
- `<Ctrl-I>` - 与 `<Ctrl-I>` 相反

## 2.2 选中

### 2.2.1 基本选择

`vim` 的选中模式多样，最基本的就是 `VISUAL` , `V-BLOCK` , `V-LINE` 模式，分别为 **普通选中模式** ， **块选中模式**， 以及 **行选中模式** 。

-  `VISUAL` - 按下 `v` 之后， 通过 `h` , `j` , `k` , `l` 或其他 [移动方式](#3.1%20移动) 
- `V-BLOCK` - 按下 `<Ctrl-V>` 之后，可以进入块选择模式，块选择模式可以选择一个块内的文本，包括不存在的文本
- `V-LINE` - 按下 `<Shift-V>` 后，进入行选择模式，可以选择一行

### 2.2.2 选中一个目标

#### 文本对象

vim 的文本对象是十分强大的。

- 单词对象 - 以空格或其他符号隔开的单词作为一个对象
	- `aw` - 单词包括单词附近的 **一个空格** ，优先后面的空格
	- `iw` - 单词本身，不包含空格
- 括号对象 - 包括 `{}` , `[]` , `()` 
	- `a<target>` - 目标括号及括号内的内容
	- `i<target>` - 目标括号内的内容
- 引号对象 - 包括 `"` , `'` 
	- `a<target>` - 目标引号及引号内的内容
	- `i<target>` - 目标引号内的内容
- 块对象 - 包括被 `{}` 和 `()` 扩起来的对象
	- `ab` - 被 `()` 括起的块及 `()` 
	- `ib` - 被 `()` 括起的块
	- `aB` - 被 `{}` 括起的块及 `{}`
	- `iB` - 被 `{}` 括起的块
- 段落对象 - 以空行隔开的段落作为一个对象
	- `ap` - 段落及一空行
	- `ip` - 段落本身

#### 选择一个文本对象

我们已经了解了在vim中的文本对象是什么，因此，要选择一个文本对象只需要 `v<target>` 即可，即使用 `v` 进入 `VISUAL` 模式，并接上要选择的文本对象。

> [!tip] 
> 文本对象其实很好记忆， `a` 代表 a ， `i` 代表 in ，文本对象则顾名思义， `w` 代表 word ， `p` 代表 paragraph ， `b` 代表 block ， `B` 代表 Block
> 
> 那么 `vap` 就是 select a paragraph ， `vaw` 就是 select a word ， `viw` 就是 select in the word， `vib` 就是 select in block

### 1.2.2 修改

`Normal` 模式下 `c` 代表的就是 `change` ，将要修改的文本删除，并进入 `Insert` 模式。使用该命令也很简单，最基本的就是 `c<target>` ，即按下 `c` 后，并接上要修改的文本对象。

例如， `ciw` 就是修改光标下的一个单词， `ci"` 就是修改引号内的文本。除了修改一个文本对象，也可以是一种移动方式 : 

- `cc` - 修改当前行
- `cj` - 修改当前行及下一行
- `c<n>j` - 修改当前行及下n行
- `<n>cc` - 修改当前起向下n行
- `C / c$` - 修改光标至行尾
- `<n>C` - 修改光标起向下n行
- `c^` - 修改光标起至行首
- `cG` - 修改光标起至末行
- `c<n>G` - 修改光标起至第n行
- `cf<char>` - 修改光标起至当前行下一个 `<char>` 处

> `c` 配合文本对象以及移动命令可以实现修改自由

### 1.2.3 替换

vim 中也含有搜索替换的功能，单纯的搜索功能在上边 [移动](#3.1%20移动) 就已经说过了，通过 `/<target>` 来实现，而替换则是需要通过命令行来实现。

替换的基本语法是 : 

```
:s/<target>/<replace>      # 替换当前行的第一项
:s/<target>/<replace>/g    # 替换当前行的全部项

:%s/<target>/<replace>     # 替换全部行的第一项
:%s/<target>/<replace>/g   # 替换全部行的全部项

:%s/<target>/<replace>/gc  # c 参数代表每次替换进行确定
```

### 1.2.4 删除

删除的符号为 `d` ，在按下 `d` 后接上任意 **移动指令** 或者 **文本对象** ，就能和 `v` , `c` 一样对特定文本进行删除 : 

- `dd` - 删除一行
- `D` - 删除光标起至行尾
- ...

### 1.2.5 复制粘贴

`y` 为复制语句， `p` 为粘贴语句，我们只需要按下 `y` 或者 `p` 再接上对象即可。

- `y` - 复制选中的对象
- `yy` 复制整行
- `p` - 在下方粘贴
- `P` - 在上方粘贴

> 注意 : 通过 `d` 命令删除的对象会默认成为剪切板中的下一个对象

### 1.2.6 mark

vim 中可以通过打记号的形式用于快速跳转位置。

#### 打记号

`m<a-z>` 用于打局部记号，该记号仅限于当前文档内使用， `m<A-Z>` 用于打全局记号，该记号可在多个 buffer 之间共享

#### 跳转到记号

`'<a-z>` 或 `'<A-Z>` 跳转到标记位置

### 1.2.7 附加命令

- `.` - 能够重复上一次执行的命令
- `q<target><record>q` - 记录宏定义，并将其存储在 `<target>` 寄存器中
- `:vsp` - 向右分割屏幕
- `:sp` - 向下分割屏幕
- `u` - undo
- `<Ctrl-R>` - redo
- `<Ctrl-x>` - 光标所在数字 -1
- `<Ctrl-a>` - 光标所在数字 +1
- `g` 系列
	- `gv` - 跳转到上一次的选择状态
	- `gi` - 跳转到上一次的输入状态
	- `gu<target>` - 将对象小写
	- `gU<target>` - 将对象大写